# PFR-AI: Cистема аналитики для ПФР

«Разработка интеллектуальной системы автоматизированного анализа и верификации пенсионных документов с использованием методов машинного 
обучения и обработки текстов»

Прототип веб-приложения для ввода данных пенсионных дел, их анализа на предмет ошибок, **анализа соответствия законодательству с помощью RAG** и отображения истории обработанных дел.

## Основные возможности

*   **Ввод данных:** Многошаговая форма для ввода персональных данных, информации о трудовом стаже и других сведений.
*   **Анализ дела:** Отправка введенных данных на бэкенд для:
    *   Проверки на основе предобученной модели классификации ошибок.
    *   **Анализа соответствия ФЗ-400 "О страховых пенсиях" с использованием Retrieval-Augmented Generation (RAG) и локальной LLM.**
*   **Отображение ошибок:** Вывод списка обнаруженных ошибок и рекомендаций после анализа.
*   **RAG Анализ:** Возможность запросить анализ введенных данных на соответствие законодательству и получить текстовый ответ от RAG-системы.
*   **История дел:** Просмотр списка ранее обработанных дел с возможностью пагинации.
*   **Экспорт документов:** Загрузка результатов базового анализа ошибок в форматах PDF и DOCX.

## Технологический стек

*   **Бэкенд:** Python, FastAPI, Pydantic, SQLAlchemy (Async), LlamaIndex (для RAG), Sentence Transformers, Scikit-learn
*   **Фронтенд:** React, TypeScript, Vite, Chakra UI, React Hook Form, React Router DOM, date-fns
*   **Модели:** Локальная LLM (через Ollama), модель эмбеддингов (через Ollama), модель классификации ошибок.

## Структура проекта

```
.
├── backend/
│   ├── app/
│   │   ├── rag_core/    # Модуль RAG (индексация, запросы)
│   │   │   ├── __init__.py
│   │   │   ├── loader.py
│   │   │   └── query_engine.py
│   │   ├── crud.py      # Операции с базой данных (CRUD)
│   │   ├── database.py  # Настройка SQLAlchemy и соединения
│   │   ├── main.py      # Основной файл FastAPI (точка входа, эндпоинты)
│   │   ├── models.py    # Pydantic модели
│   │   └── services.py  # Сервисный слой (генерация документов и т.п.)
│   ├── data/          # Данные (исходный PDF, файлы индекса RAG)
│   ├── error_classifier.py # Модуль классификатора ошибок
│   ├── requirements.txt # Зависимости Python
│   └── README.md      # Документация бэкенда
├── frontend/
│   ├── public/
│   ├── src/
│   │   ├── components/
│   │   │   ├── formInputs/
│   │   │   ├── formSteps/
│   │   │   ├── CaseForm.tsx     # Форма, включая кнопку RAG-анализа
│   │   │   ├── HistoryList.tsx
│   │   │   └── ErrorDisplay.tsx
│   │   ├── pages/
│   │   ├── App.tsx
│   │   ├── main.tsx
│   │   ├── theme.ts
│   │   └── utils.ts
│   ├── package.json
│   ├── tsconfig.json
│   ├── vite.config.ts
│   └── README.md
└── README.md # Этот файл
```

## Быстрый старт

### Предпосылки

*   Установлен Python 3.9+
*   Установлен Node.js и npm/yarn
*   **Установлен и запущен Ollama** с необходимыми моделями (например, `gemma3`, `mxbai-embed-large`). Убедитесь, что Ollama доступен по адресу `http://localhost:11434`.

### Бэкенд

1.  Перейдите в директорию `backend`:
    ```bash
    cd backend
    ```
2.  Создайте и активируйте виртуальное окружение:
    ```bash
    python -m venv venv
    # Windows
    .\venv\Scripts\activate
    # macOS/Linux
    source ./venv/bin/activate
    ```
3.  Установите зависимости:
    ```bash
    pip install -r requirements.txt
    ```
4.  **(Первый запуск) Инициализация RAG индекса:** При первом запуске сервера FastAPI произойдет автоматическая индексация документа из папки `backend/data`. Это может занять несколько минут. Следите за логами в консоли.
5.  Запустите сервер FastAPI:
    ```bash
    uvicorn app.main:app --reload --port 8000
    ```
    Сервер будет доступен по адресу `http://127.0.0.1:8000`.

### Фронтенд

1.  Перейдите в директорию `frontend`:
    ```bash
    cd frontend
    ```
2.  Установите зависимости:
    ```bash
    npm install
    ```
3.  Запустите сервер для разработки:
    ```bash
    npm run dev
    ```
    Приложение будет доступно по адресу `http://localhost:5173` (или другому порту, указанному Vite).

## Дальнейшие шаги

*   См. `backend/README.md` для детальной информации о бэкенде.
*   См. `frontend/README.md` для детальной информации о фронтенде.