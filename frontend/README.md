# PFR-AI: Фронтенд

Клиентская часть приложения для анализа пенсионных дел, разработанная с использованием React, TypeScript и Chakra UI.

**Недавние изменения:**
*   Проведена унификация модуля для взаимодействия с API: удален дублирующийся файл `src/api/client.ts`, теперь используется `src/services/client.ts`.
*   Добавлены типы (`OcrExtractionResponse` и др. в `src/types.ts`) и функция (`extractDocumentData` в `src/services/client.ts`) для будущей интеграции OCR-модуля.

## Функциональность

*   Отображает многошаговую форму для ввода данных пенсионного дела.
*   Использует `react-hook-form` для управления состоянием формы и валидации.
*   Использует `react-datepicker` и `react-imask` (через `CustomDateInput`) для удобного ввода дат и СНИЛС с масками.
*   **Использует кастомный компонент `TagInput` для удобного ввода списков льгот и документов.**
*   Отправляет данные формы на бэкенд (`/process`) для базового анализа и сохранения **через функции в `src/services/client.ts`**.
*   Предоставляет кнопку "RAG Анализ", которая отправляет описание дела на эндпоинт `/api/v1/analyze_case` **через функции в `src/services/client.ts`**.
*   Отображает текстовый результат RAG-анализа в отдельном блоке под формой.
*   Отображает результаты базового анализа (`ProcessResult`) с помощью компонента `ProcessResultDisplay` и уведомлений `useToast`.
*   Реализует отдельную страницу для просмотра истории обработанных дел (`/history`).
*   Загружает и отображает историю дел с помощью компонента `HistoryList`, **используя API-клиент из `src/services/client.ts`**.
*   Позволяет скачивать документы (PDF/DOCX) для записей истории, **обращаясь к API через `src/services/client.ts`**.
*   Использует `react-router-dom` для навигации между страницами.
*   Использует кастомную тему `Chakra UI` (`theme.ts`) **с возможностью переключения между светлым и темным режимами**.
*   **(В разработке)** Функциональность OCR для предзаполнения данных из документов через эндпоинт `/extract_document_data`. Шаг OCR теперь является вторым шагом в форме, после выбора типа пенсии.

## Основные компоненты

*   **`App.tsx`**: Корневой компонент, настраивает маршрутизацию, **отображает навигацию и переключатель тем**.
*   **`pages/HistoryPage.tsx`**: Страница отображения истории. Загружает данные с `/history` **через API-клиент**, отображает `HistoryList`.
*   **`components/CaseForm.tsx`**: Компонент-контейнер для многошаговой формы. Управляет активным шагом, **вызывает функции API-клиента для отправки данных**, рендерит компоненты шагов и результаты RAG.
*   **`components/formSteps/*`**: Компоненты для шагов формы.
*   **`components/formInputs/*`**: Переиспользуемые компоненты для полей формы (`CustomDateInput`, `TagInput`).
*   **`components/HistoryList.tsx`**: Компонент для отображения списка истории дел.
*   **`components/ProcessResultDisplay.tsx`**: Компонент для отображения результатов базового анализа.
*   **`theme.ts`**: Файл определения кастомной темы Chakra UI (светлая/темная).
*   **`services/client.ts`**: **Модуль с функциями для взаимодействия с API бэкенда.**
*   **`utils.ts`**: Содержит вспомогательные функции.

## Установка и запуск

1.  **Требования:** Node.js (рекомендуется LTS версия), npm.
2.  Перейдите в директорию `frontend`:
    ```bash
    cd frontend
    ```
3.  **Установка зависимостей:**
    ```bash
    npm install
    ```
    Основные зависимости:
    *   `react`, `react-dom`: Библиотека UI.
    *   `typescript`: Типизация JavaScript.
    *   `@chakra-ui/react`, `@chakra-ui/icons`, `@emotion/react`, `@emotion/styled`, `framer-motion`: Библиотека UI компонентов и анимации.
    *   `react-hook-form`: Управление формами.
    *   `react-router-dom`: Маршрутизация.
    *   `react-datepicker`: Компонент выбора даты.
    *   `react-imask`: Компонент для масок ввода.
    *   `date-fns`: Библиотека для работы с датами.
    *   `react-icons`: Библиотека иконок.
    *   `react-toastify`: Уведомления.
    *   ~~`axios`: Для выполнения HTTP-запросов к бэкенду.~~ (Удалено, используется `fetch` в `src/services/client.ts`)
4.  **Запуск сервера для разработки:**
    ```bash
    npm run dev
    ```
    Приложение будет доступно по адресу `http://localhost:5173` (или другому порту, указанному Vite). Сервер поддерживает Hot Module Replacement (HMR).
5.  **Сборка для продакшена:**
    ```bash
    npm run build
    ```
    Готовые к развертыванию файлы будут помещены в директорию `dist`.
6.  **Линтинг:**
    ```bash
    npm run lint
    ```

## Зависимость от Бэкенда

Фронтенд ожидает, что бэкенд запущен и доступен. Адрес бэкенда (`API_BASE_URL`) настраивается через переменные окружения Vite (например, в файле `.env.local` можно указать `VITE_API_BASE_URL=http://127.0.0.1:8000`). По умолчанию используется `http://localhost:8000`. Все API запросы направляются на этот адрес **через функции в `src/services/client.ts`**.
